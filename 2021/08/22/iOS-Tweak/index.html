

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
  <title>iOSä¹‹Tweak - Cola&#39;S Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.11","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Cola'S Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="iOSä¹‹Tweak">
              
                iOSä¹‹Tweak
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-08-22 21:02" pubdate>
        2021å¹´8æœˆ22æ—¥ æ™šä¸Š
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      1.4k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      19
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">iOSä¹‹Tweak</h1>
            
            <div class="markdown-body">
              <h2 id="ç¼–å†™HOOKæ’ä»¶"><a href="#ç¼–å†™HOOKæ’ä»¶" class="headerlink" title="ç¼–å†™HOOKæ’ä»¶"></a>ç¼–å†™HOOKæ’ä»¶</h2><h3 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">1</span>. ç»ˆç«¯è¾“å…¥<span class="hljs-selector-tag">nic</span><span class="hljs-selector-class">.pl</span><br><span class="hljs-selector-tag">2</span>. <span class="hljs-selector-tag">Choose</span> <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">Template</span> (required): <span class="hljs-selector-tag">10</span><br><span class="hljs-selector-tag">3</span>. <span class="hljs-selector-tag">Project</span> <span class="hljs-selector-tag">Name</span> (required): å·¥ç¨‹å<br><span class="hljs-selector-tag">4</span>. <span class="hljs-selector-tag">Package</span> <span class="hljs-selector-tag">Name</span> <span class="hljs-selector-attr">[com.yourcompany.tututest]</span>:  åŒ…å:<span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span><br><span class="hljs-selector-tag">5</span>. <span class="hljs-selector-tag">Author</span>/<span class="hljs-selector-tag">Maintainer</span> <span class="hljs-selector-tag">Name</span> <span class="hljs-selector-attr">[lk]</span>: ä½œè€…<br><span class="hljs-selector-tag">6</span>. <span class="hljs-selector-attr">[iphone/tweak]</span> <span class="hljs-selector-tag">MobileSubstrate</span> <span class="hljs-selector-tag">Bundle</span> <span class="hljs-selector-tag">filter</span> <span class="hljs-selector-attr">[com.apple.springboard]</span>: è¦<span class="hljs-selector-tag">Hook</span>çš„åŒ…å<br><span class="hljs-selector-tag">7</span>. <span class="hljs-selector-attr">[iphone/tweak]</span> <span class="hljs-selector-tag">List</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">applications</span> <span class="hljs-selector-tag">to</span> <span class="hljs-selector-tag">terminate</span> <span class="hljs-selector-tag">upon</span> <span class="hljs-selector-tag">installation</span> (space-separated, <span class="hljs-string">&#x27;-&#x27;</span> for none) <span class="hljs-selector-attr">[SpringBoard]</span>: å›è½¦é»˜è®¤<br><br></code></pre></td></tr></table></figure>

<h3 id="å·¥ç¨‹æ–‡ä»¶ç®€ä»‹"><a href="#å·¥ç¨‹æ–‡ä»¶ç®€ä»‹" class="headerlink" title="å·¥ç¨‹æ–‡ä»¶ç®€ä»‹"></a>å·¥ç¨‹æ–‡ä»¶ç®€ä»‹</h3><p>åˆ›å»ºå¥½çš„å·¥ç¨‹ä¸‹å…±æœ‰4ä¸ªæ–‡ä»¶</p>
 <img src="/2021/08/22/iOS-Tweak/images/tweakproject.png" srcset="/img/loading.gif" lazyload class="">

<ul>
<li><p>Makefile   ç¼–è¯‘æ–‡ä»¶</p>
</li>
<li><p>Tweak.x    ç¼–å†™HOOKæ–‡ä»¶</p>
</li>
<li><p>control     æ’ä»¶ä½œè€…ã€ç‰ˆæœ¬ä¿¡æ¯</p>
</li>
<li><p>demo001.plist  è®¾ç½®è¦HOOKçš„Bundle ID</p>
</li>
</ul>
<h4 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h4><p>æŒ‡å®šå·¥ç¨‹ç”¨åˆ°çš„æ–‡ä»¶,æ¡†æ¶,åº“ç­‰ä¿¡æ¯,å°†æ•´ä¸ªè¿‡ç¨‹è‡ªåŠ¨åŒ–</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs makefile">INSTALL_TARGET_PROCESSES = SpringBoard<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$(THEOS)</span>/makefiles/common.mk<br><br>TWEAK_NAME = demo001<br><br>demo001_FILES = Tweak.x<br>demo001_CFLAGS = -fobjc-arc<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$(THEOS_MAKE_PATH)</span>/tweak.mk<br></code></pre></td></tr></table></figure>

<ol>
<li>INSTALL_TARGET_PROCESSES = SpringBoard ç›®æ ‡å®‰è£…çš„é¡¹ç›®</li>
<li>include $(THEOS)/makefiles/common.mk å›ºå®šå†™æ³• </li>
<li>TWEAK_NAME = demo001 tweakçš„åç§°</li>
<li>demo001_FILES = Tweak.x tweakæºæ–‡ä»¶,å¤šä¸ªæ–‡ä»¶ä»¥ç©ºæ ¼åˆ†éš”</li>
<li>include $(THEOS_MAKE_PATH)/tweak.mk é€šè¿‡includeå‘½ä»¤æŒ‡å®šä¸åŒçš„.mkæ–‡ä»¶</li>
</ol>
<p>é™¤äº†ä¸Šé¢çš„ä¿¡æ¯æ ¼å¼,æˆ‘ä»¬è¿˜å¯ä»¥æ·»åŠ ä»¥ä¸‹ä¿¡æ¯</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs makefile">æˆ‘ä»¬å¦‚ä½•é€šè¿‡è¿›è¡ŒæŒ‡å®šSDK?<br>TARGET = iPhone:latest:8.0 <br><br>æˆ‘ä»¬å¦‚ä½•å¯¼å…¥framework?<br>demo001_FRAMWORKS = UIKit  <br><br>æˆ‘ä»¬å¦‚ä½•æŒ‡å®šå¤„ç†å™¨æ¶æ„<br>ARCHS = armv7 arm64  <br><br>æˆ‘ä¹ˆå¦‚ä½•é“¾æ¥Mach-Oå¯¹è±¡<br>demo001_LDFLAGS = -lx<br>æ³¨æ„<br>-lx ä»£è¡¨é“¾æ¥libx.aæˆ–libx.dylib,å³ç»™xåŠ ä¸Šlibçš„å‰ç¼€,ä»¥åŠ.aæˆ–.dylibçš„åç¼€,å¯ä»¥æ ¹æ®è‡ªå·±çš„é¡¹ç›®è¿›è¡Œè°ƒæ•´<br><br></code></pre></td></tr></table></figure>

<h4 id="Tweak-x"><a href="#Tweak-x" class="headerlink" title="Tweak.x"></a>Tweak.x</h4><p>xm ä¸­çš„xä»£è¡¨è¿™ä¸ªæ–‡ä»¶æ”¯æŒLogosè¯­æ³•</p>
<p>x å¦‚æœåç¼€åæ˜¯å•ç‹¬çš„x,è¯´æ˜æºæ–‡ä»¶æ”¯æŒLogoså’ŒCè¯­æ³•;</p>
<p>xm å¦‚æœåç¼€åæ˜¯xm,è¯´æ˜æºæ–‡ä»¶æ”¯æŒLogoså’ŒC/C++è¯­æ³•.</p>
<p>.xi å°†é¦–å…ˆä½œä¸ºobjective-cè¿›è¡Œé¢„å¤„ç†ï¼Œç„¶åLogoså°†å¤„ç†ç»“æœï¼Œç„¶åå°†è¿›è¡Œç¼–è¯‘ã€‚</p>
<p>.xmi å°†é¦–å…ˆä½œä¸ºobjective-c ++è¿›è¡Œé¢„å¤„ç†ï¼Œç„¶åLogoså°†å¤„ç†ç»“æœï¼Œç„¶åå°†è¿›è¡Œç¼–è¯‘ã€‚</p>
<h4 id="demo001-plist"><a href="#demo001-plist" class="headerlink" title="demo001.plist"></a>demo001.plist</h4><p>ç”¨äºæŒ‡å®šéœ€è¦æ³¨å…¥çš„ç›®æ ‡æ–‡ä»¶çš„Bundle ID</p>
<h4 id="control"><a href="#control" class="headerlink" title="control"></a>control</h4><p>æŒ‡å®šdebåŒ…çš„ä¸€äº›ä¿¡æ¯,åŒ…æ‹¬åå­—,æè¿°,ç‰ˆæœ¬å·ç­‰</p>
<h3 id="ç¼–å†™HOOKä»£ç "><a href="#ç¼–å†™HOOKä»£ç " class="headerlink" title="ç¼–å†™HOOKä»£ç "></a>ç¼–å†™HOOKä»£ç </h3><p>ç¼–è¾‘tweak.x</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-comment">//hook ViewControllerçš„testæ–¹æ³•</span><br><span class="hljs-tag"></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> ViewController<br><br>-<span class="ruby"> (void)test&#123;</span><br><span class="ruby"></span><br>    NSLog(@&quot;ğŸºğŸºğŸºHOOKğŸºğŸºğŸº&quot;);<br>&#125;<br><span class="hljs-tag"></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span><br></code></pre></td></tr></table></figure>

<p>è®¾ç½®ç¯å¢ƒå˜é‡</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-builtin-name">export</span> THEOS_DEVICE_IP = localhost<br><span class="hljs-builtin-name">export</span> THEOS_DEVICE_PORT = 2222<br></code></pre></td></tr></table></figure>

<h3 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="headerlink" title="ç¼–è¯‘å®‰è£…"></a>ç¼–è¯‘å®‰è£…</h3><p>ä½¿ç”¨iproxyè½¬å‘æ‰‹æœº22ç«¯å£åˆ°æœ¬åœ°2222</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">iproxy</span> <span class="hljs-number">2222</span> <span class="hljs-number">22</span><br></code></pre></td></tr></table></figure>

<p>ç»ˆç«¯è¾“å…¥ makeï¼›make package install</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">make</span><br><span class="hljs-built_in">make</span> <span class="hljs-keyword">package</span> install<br></code></pre></td></tr></table></figure>


<h2 id="Logosè¯­æ³•"><a href="#Logosè¯­æ³•" class="headerlink" title="Logosè¯­æ³•"></a>Logosè¯­æ³•</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//i</span>phonedevwiki.net<span class="hljs-regexp">/index.php/</span>Logos<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Logosè¯­æ³•</th>
<th>åŠŸèƒ½è§£é‡Š</th>
<th>äº‹ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>%hook</td>
<td>éœ€è¦hookå“ªä¸ªç±»</td>
<td>%hook Classname</td>
</tr>
<tr>
<td>%end</td>
<td>ä»£ç å—ç»“æŸæ ‡è®°</td>
<td>%end</td>
</tr>
<tr>
<td>%group</td>
<td>åˆ†ç»„</td>
<td>%group Groupname</td>
</tr>
<tr>
<td>%new</td>
<td>æ·»åŠ æ–°æ–¹æ³•</td>
<td>%new(signature)</td>
</tr>
<tr>
<td>%ctor</td>
<td>æ„é€ å‡½æ•°</td>
<td>%ctor { â€¦ }</td>
</tr>
<tr>
<td>%dtor</td>
<td>ææ„å‡½æ•°</td>
<td>%dtor { â€¦ }</td>
</tr>
<tr>
<td>%log</td>
<td>è¾“å‡ºæ‰“å°</td>
<td>%log; %log([(), â€¦]);</td>
</tr>
<tr>
<td>%orig</td>
<td>ä¿æŒåŸæœ‰æ–¹æ³•</td>
<td>%origï¼›%orig(arg1, â€¦)ï¼›</td>
</tr>
<tr>
<td>%c</td>
<td>åŠ¨æ€è·å–ç±»</td>
<td>%c([+/-]Class)ï¼›</td>
</tr>
</tbody></table>
<h3 id="1-hook-end"><a href="#1-hook-end" class="headerlink" title="1. %hook %end"></a>1. %hook %end</h3><p>æŒ‡å®šéœ€è¦hookçš„class,å¿…é¡»ä»¥ï¼…endç»“å°¾ã€‚</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-comment">// hook SpringBoardç±»é‡Œé¢çš„_menuButtonDownå‡½æ•°,å…ˆæ‰“å°ä¸€å¥è¯,å†ä¹‹å­é‚£ä¸ªå‡½æ•°åŸå§‹çš„æ“ä½œ</span><br><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> SpringBorad<br>-<span class="ruby"> (void)<span class="hljs-symbol">_menuButtonDown:</span>(id)down</span><br><span class="ruby"></span>&#123;<br>    NSLog(@&quot;111111&quot;);<br><span class="hljs-tag">   %<span class="hljs-selector-tag">orig</span></span>; // è°ƒç”¨åŸå§‹çš„_menuButtonDownå‡½æ•°<br>&#125;<br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span><br></code></pre></td></tr></table></figure>

<h3 id="2-group"><a href="#2-group" class="headerlink" title="2.%group"></a>2.%group</h3><p>è¯¥æŒ‡ä»¤ç”¨äºå°†%hookåˆ†ç»„ï¼Œä¾¿äºä»£ç ç®¡ç†åŠæŒ‰æ¡ä»¶åˆå§‹åŒ–åˆ†ç»„ï¼Œå¿…é¡»ä»¥%endç»“å°¾ã€‚ </p>
<p>ä¸€ä¸ªï¼…groupå¯ä»¥åŒ…å«å¤šä¸ª%hook,æ‰€æœ‰ä¸å±äºæŸä¸ªè‡ªå®šä¹‰groupçš„ï¼…hookä¼šè¢«éšå¼å½’ç±»åˆ°ï¼…group_ungroupedä¸­ã€‚</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">group</span></span> iOS8<br><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> IOS8_SPECIFIC_CLASS<br><span class="hljs-comment">    // your code here</span><br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span> // end hook<br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span> // end group ios8<br><span class="hljs-tag"></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">group</span></span> iOS9<br><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> IOS9_SPECIFIC_CLASS<br><span class="hljs-comment">    // your code here</span><br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span> // end hook<br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span> // end group ios9<br><span class="hljs-tag"></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">ctor</span></span> &#123;<br>    if (kCFCoreFoundationVersionNumber &gt; 1200) &#123;<br><span class="hljs-tag">        %<span class="hljs-selector-tag">init</span>(iOS9)</span>;<br>    &#125; else &#123;<br><span class="hljs-tag">        %<span class="hljs-selector-tag">init</span>(iOS8)</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-new"><a href="#3-new" class="headerlink" title="3.%new"></a>3.%new</h3><p>åœ¨%hookå†…éƒ¨ä½¿ç”¨ï¼Œç»™ä¸€ä¸ªç°æœ‰classæ·»åŠ æ–°å‡½æ•°ï¼ŒåŠŸèƒ½ä¸class_addMethodç›¸åŒ. </p>
<p>æ³¨ï¼š<br>Objective-Cçš„categoryä¸class_addMethodçš„åŒºåˆ«ï¼š </p>
<p>å‰è€…æ˜¯é™æ€çš„è€Œåè€…æ˜¯åŠ¨æ€çš„ã€‚ä½¿ç”¨%newæ·»åŠ ,è€Œä¸éœ€è¦å‘.hæ–‡ä»¶ä¸­æ·»åŠ å‡½æ•°å£°æ˜,å¦‚æœä½¿ç”¨category,å¯èƒ½ä¸é‡åˆ°è¿™æ ·é‚£æ ·çš„é”™è¯¯.</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> SpringBoard<br><span class="hljs-tag">%<span class="hljs-selector-tag">new</span></span><br>-<span class="ruby"> (void)addNewMethod</span><br><span class="ruby"></span>&#123;<br>    NSLog(@&quot;åŠ¨æ€æ·»åŠ ä¸€ä¸ªæ–¹æ³•åˆ°SpringBoard&quot;);<br>&#125;<br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span><br></code></pre></td></tr></table></figure>

<h3 id="4-ctor"><a href="#4-ctor" class="headerlink" title="4.%ctor"></a>4.%ctor</h3><p>tweakçš„constructor,å®Œæˆåˆå§‹åŒ–å·¥ä½œï¼›å¦‚æœä¸æ˜¾ç¤ºå®šä¹‰ï¼ŒTheosä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª%ctor,å¹¶åœ¨å…¶ä¸­è°ƒç”¨%init(_ungrouped)ã€‚</p>
<p>%ctorä¸€èˆ¬å¯ä»¥ç”¨æ¥åˆå§‹åŒ–%group,ä»¥åŠè¿›è¡ŒMSHookFunctionç­‰æ“ä½œ,å¦‚ä¸‹:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-meta">#ifndef KCFCoreFoundationVersionNumber_iOS_8_0</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> KCFCoreFoundationVersionNumber_iOS_8_0      1140.10</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>%ctor<br>&#123;<br>    %<span class="hljs-keyword">init</span>;<br><br>    <span class="hljs-keyword">if</span> (KCFCoreFoundationVersionNumber &gt;= KCFCoreFoundationVersionNumber_iOS_7_0 &amp;&amp; KCFCoreFoundationVersionNumber &gt; KCFCoreFoundationVersionNumber_iOS_8_0)<br>    %<span class="hljs-keyword">init</span>(iOS7Hook);<br> <span class="hljs-keyword">if</span> (KCFCoreFoundationVersionNumber &gt;= KCFCoreFoundationVersionNumber_iOS_8_0)<br>    %<span class="hljs-keyword">init</span>(iOS8Hook);<br>MSHookFunction((<span class="hljs-keyword">void</span> *)&amp;AudioServicesPlaySystemSound,(<span class="hljs-keyword">void</span> *)&amp;replaced_AudioServerPlaySystemSound,(<span class="hljs-keyword">void</span> **)&amp;orginal_AudioServicesPlaySystemSound);<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="5-dtor"><a href="#5-dtor" class="headerlink" title="5.%dtor"></a>5.%dtor</h3><p>Generate an anonymous deconstructor (of default priority).</p>
<h3 id="6-log"><a href="#6-log" class="headerlink" title="6.%log"></a>6.%log</h3><p>è¯¥æŒ‡ä»¤åœ¨%hookå†…éƒ¨ä½¿ç”¨ï¼Œå°†å‡½æ•°çš„ç±»åã€å‚æ•°ç­‰ä¿¡æ¯å†™å…¥syslog,å¯ä»¥ï¼…log([(),â€¦..])çš„æ ¼å¼è¿½åŠ å…¶ä»–æ‰“å°ä¿¡æ¯ã€‚</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> SpringBorad<br>-<span class="ruby"> (void)<span class="hljs-symbol">_menuButtonDown:</span>(id)down</span><br><span class="ruby"></span>&#123;<br><span class="hljs-tag">    %<span class="hljs-selector-tag">log</span>((NSString *)</span>@&quot;iosre&quot;,(NSString *)@&quot;Debug&quot;);<br><span class="hljs-tag">    %<span class="hljs-selector-tag">orig</span></span>; // è°ƒç”¨åŸå§‹çš„_menuButtonDownæ–¹æ³•<br>&#125;<br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span><br></code></pre></td></tr></table></figure>

<h3 id="7-orig"><a href="#7-orig" class="headerlink" title="7.%orig"></a>7.%orig</h3><p>è¯¥æŒ‡ä»¤åœ¨%hookå†…éƒ¨ä½¿ç”¨ï¼Œæ‰§è¡Œè¢«hookçš„å‡½æ•°çš„åŸå§‹ä»£ç ï¼›ä¹Ÿå¯ä»¥ç”¨ï¼…origæ›´æ”¹åŸå§‹å‡½æ•°çš„å‚æ•°ã€‚</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> SpringBorad<br>-<span class="ruby"> (void)<span class="hljs-symbol">setCustomSubtitleText:</span>(id)arg1 <span class="hljs-symbol">withColor:</span>   (id)arg2</span><br><span class="ruby"></span>&#123;<br><span class="hljs-tag">    %<span class="hljs-selector-tag">orig</span>(@&quot;change arg2&quot;,arg2)</span>;// å°†arg2çš„å‚æ•°ä¿® æ”¹ä¸º&quot;change arg2&quot;<br>&#125;<br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span><br></code></pre></td></tr></table></figure>

<h3 id="8-init"><a href="#8-init" class="headerlink" title="8.%init"></a>8.%init</h3><p>è¯¥æŒ‡ä»¤ç”¨äºåˆå§‹åŒ–æŸä¸ªï¼…groupï¼Œå¿…é¡»åœ¨%hookæˆ–ï¼…ctorå†…è°ƒç”¨ï¼›å¦‚æœå¸¦å‚æ•°ï¼Œåˆ™åˆå§‹åŒ–æŒ‡å®šçš„groupï¼Œå¦‚æœä¸å¸¦å‚æ•°ï¼Œåˆ™åˆå§‹åŒ–_ungrouped. </p>
<p>æ³¨ï¼š åˆ‡è®°ï¼Œåªæœ‰è°ƒç”¨äº†ï¼…init,å¯¹åº”çš„%groupæ‰èƒ½èµ·ä½œç”¨ï¼</p>
<h3 id="9-c"><a href="#9-c" class="headerlink" title="9.%c"></a>9.%c</h3><p>è¯¥æŒ‡ä»¤çš„ä½œç”¨ç­‰åŒäºobjc_getClassæˆ–NSClassFromString,å³åŠ¨æ€è·å–ä¸€ä¸ªç±»çš„å®šä¹‰ï¼Œåœ¨%hookæˆ–ï¼…ctorå†…ä½¿ç”¨ ã€‚</p>
<p>è°ƒç”¨ViewControllerä¸­çš„Methodæ–¹æ³•</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">[[[%c(ViewController) alloc ] init]<span class="hljs-function"><span class="hljs-keyword">Method</span>];</span> <br></code></pre></td></tr></table></figure>



<h2 id="æ—¥å¿—æ‰“å°"><a href="#æ—¥å¿—æ‰“å°" class="headerlink" title="æ—¥å¿—æ‰“å°"></a>æ—¥å¿—æ‰“å°</h2><p>hook demoæ–¹æ³•å¹¶æ·»åŠ æ‰“å°å…¥å‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs objectivec"> <br><span class="hljs-meta">#import <span class="hljs-meta-string">&quot;ViewController.h&quot;</span></span><br><br><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">ViewController</span> ()</span><br> <span class="hljs-comment">//ç‚¹å‡»äº‹ä»¶</span><br>- (<span class="hljs-keyword">IBAction</span>)compute;<br><br><span class="hljs-keyword">@end</span><br><br><span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">ViewController</span></span><br><br>- (<span class="hljs-keyword">void</span>)viewDidLoad &#123;<br>    [<span class="hljs-keyword">super</span> viewDidLoad];<br>    <span class="hljs-comment">// Do any additional setup after loading the view.</span><br>    <br>&#125;<br> <br>- (<span class="hljs-keyword">IBAction</span>)compute &#123;<br>    <br>    [<span class="hljs-keyword">self</span> demo:<span class="hljs-string">@&quot;66&quot;</span>];<br>    <br>&#125;<br> <br>- (<span class="hljs-keyword">void</span>)demo:(<span class="hljs-built_in">NSString</span> *)str&#123;<br>   <span class="hljs-built_in">NSString</span> *res = [str stringByAppendingString:<span class="hljs-string">@&quot;ğŸ‚ğŸ‚ğŸ‚&quot;</span>];<br>    <span class="hljs-built_in">NSLog</span>(res);<br>  <br>    <br>&#125;<br><span class="hljs-keyword">@end</span><br><br></code></pre></td></tr></table></figure>

<p>logify.plç”Ÿæˆ.xmæ–‡ä»¶</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">//æ ¹æ®class-dumpåçš„ViewController.hç”Ÿæˆ.xæ–‡ä»¶</span><br>logify.pl <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ViewController</span>.</span></span>h &gt;<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Tweak</span>.</span></span>x<br></code></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¹‹å…³ç³»ç¨‹åºä¸­è‡ªå·±å†™çš„æ–¹æ³•</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-comment">//ç»è¿‡åˆ å‡è¿‡åçš„Tweak.xæ–‡ä»¶</span><br><span class="hljs-tag"></span><br><span class="hljs-tag">%<span class="hljs-selector-tag">hook</span></span> ViewController<br> <br>-<span class="ruby"> (void)<span class="hljs-symbol">demo:</span>(id)arg1 &#123; %log; %orig; &#125;</span><br><span class="ruby"></span><span class="hljs-tag"> </span><br><span class="hljs-tag">%<span class="hljs-selector-tag">end</span></span><br><br></code></pre></td></tr></table></figure>

<p>å°†ç”Ÿæˆçš„Tweak.xæ–‡ä»¶æ›¿æ¢theosç”Ÿæˆçš„Tweak.xæ–‡ä»¶åç¼–è¯‘å®‰è£…å³å¯</p>
<p>æŸ¥çœ‹æ‰“å°æ—¥å¿—</p>
 <img src="/2021/08/22/iOS-Tweak/images/logify.png" srcset="/img/loading.gif" lazyload class="">

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/iOS/">iOS</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/hook/">hook</a>
                    
                      <a class="hover-with-bg" href="/tags/iOS/">iOS</a>
                    
                      <a class="hover-with-bg" href="/tags/tweak/">tweak</a>
                    
                  </div>
                
              </div>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/08/22/iOS-cycript/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">iOSä¹‹cycript</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/08/22/IOS%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/">
                        <span class="hidden-mobile">IOSæ–‡ä»¶ç»“æ„</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>




















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
